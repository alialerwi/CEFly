{"name":"CEFly","tagline":"CEF exporting for Splunk","body":"What is CEFly?\r\n------------------------------------\r\n\r\nCEFly ( pronounced sef lee ) is an app that allows Splunk to output its events in something called \"CEF format\" via syslog to a receiver such as HP's ArcSight ESM or ArcSight Logger.\r\n\r\nCEF aka \"Common Event Format\" is a standard derived by ArcSight for the interoperability of logging events between different systems and central logging solutions.  Many vendors output their logs in CEF format and use the standard syslog protocol to send its events to a destination server that supports CEF such as HP's ArcSight. \r\n\r\nWhy did you make this?\r\n------------------------------------\r\n\r\n\r\nSplunk is great tool for centralized log aggregation and reporting; however my company, like many others also utilize SIEM ( Security, Information and Event Monitoring ) tools for daily Security Operations Center (SOC) work.  While Splunk was by far the best logging and reporting tool we had at our disposal, the data in it was too siloed when it came to integrating it with the SIEM; i.e. there was no good way to export data from Splunk into the SIEM natively without alot of work on the SIEM side of things.  \r\n\r\nIn steps CEFly.  \r\n\r\nSince the SIEM accepts CEF natively, I figured we could utilize Splunk to translate the events inside of it into CEF messages that could be sent via syslog to our SIEM by utilizing the powerful features such Saved Reporting, Alerting, and Scripted Outputs. \r\n\r\nBy utilizing these features, all messages for an entire log source or even down to just specific events can be sent to the SIEM as needed having Splunk act as both a 'filter' and translator for the CEF format.  All you need is a Saved Search with an Alert and a definition in cefly.conf to define and map the Splunk fields to the CEF Fields accordingly and that is it.\r\n\r\n\r\nHow do I use it?\r\n------------------------------------\r\n\r\n1. Download and extract this app and its contents to $SPLUNK_HOME/etc/apps\r\n2. Copy the savedsearches.conf from default into local/savedsearches.conf\r\n3. Copy cefly.conf from default/cefly.conf to local/cefly.conf\r\n4. Create or modify a new entry in local/savedsearches.conf for the search you wish to run to get the events you want CEFly out\r\n5. Create a new entry or modify an example in local/cefly.conf with a label name the same as your saved search from above\r\n6. Define your cefly outputs, use the example provided from default/cefly.conf for clarification\r\n\r\nDo you have a list of CEF Field names to make mapping easier?\r\n-----------------------------------\r\n\r\nYes I do, please checkout share/cef_maps.csv for a list off supported CEF field names for ArcSight Logger.\r\n\r\nThings you should know:\r\n------------------------------------\r\n\r\n1. The label in cefly.conf and savedsearches.conf  must be exact for the log type you want to output.  Check out the example default/cefly.conf and default/savesearches.conf for clarification and how they match up.\r\n2. You can do real time searches instead of scheduled searches, however, I find that scheduled searches take up much less resources on the system.  I have tested this with fairly big sources with searches that run every minute with no issues.  Realtime for the same source were causing a pretty noticeable performance impact for the same ammount of data.  My suggestion is not use real time unless you absolutely have to for this reason, since at most you your outputted event will be one minute behind which was acceptable for our needs and kept load on the server down considerably.\r\n3. CEFly keeps metrics about itself in the _internal index, or under the $SPLUNK_HOME/var/log/splunk/cefly.log file.\r\n\r\nHow much testing have you done?\r\n------------------------------------\r\n\r\nI have been using CEFly for a few months now, outputting 30+GB of data per day with no issues.  We havent seen any major issues, and as long as the Saved Searches arent real time, we havent seen any load or resource issues with the 15 or so outputs we have configured today.  If you run it, and for some reason encouter an issue, please get in contact with me.\r\n\r\nWhats next:\r\n------------------------------------\r\n\r\n1. I plan to make a web UI for the configuration/setup of CEFly in the future so we don't have edit/create config files manually\r\n2. More enhancements to the dashboard such as drilldowns, more/prettier graphs etc\r\n\r\n\r\n\r\nIssues / Comments / Concerns?\r\n------------------------------------\r\n\r\nIf you have any questions, comments or concerns, please get in contact with me.  Please also feel free to fork this project if you have anything you would like to add.\r\n\r\nemail me: nickmaccarthy@gmail.com\r\n\r\n\r\n### Author: Nick MacCarthy\r\n### Email: nickmaccarthy@gmail.com","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}